<table><thead id="table-collapse-toggle-0" class="collapsible collapsed" onclick ="collapse_table('0')"><tr><th> Table of Contents </th></tr></thead><tbody id="collapsible-table-0" class="invisible"><tr><td><div class="toc"><ol type="1"><li><a href="#injective-and-disjoint">Injective and Disjoint</a><ol type="1"><li><a href="#injection">injection</a></li><li><a href="#discriminate">discriminate</a></li><li><a href="#f_equal">f_equal</a></li></ol></li></ol></div></td></tr></tbody></table><h1 id="injective-and-disjoint">Injective and Disjoint</h1><p>자연수의 정의를 다시 떠올려볼까요?</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Inductive</span><span class="color-white"> nat </span><span class="color-white">:</span> <span class="color-gold">Type</span> <span class="color-white">:=</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code">  <span class="color-white">|</span> <span class="color-gold">O</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code">  <span class="color-white">|</span> <span class="color-gold">S</span><span class="color-white"> (n </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(0)">Copy</button></pre><p>위의 정의에서 저희는 아주 당연한 사실 2가지를 생각해볼 수 있습니다.</p><ul><li><code class="inline-code-span">S</code>는 injective<span class="footnote-ref" id="footnote-ref-0"><a href="#footnote-cite-0">[0]</a></span>합니다. 즉, <code class="inline-code-span">S n = S m</code>이면 <code class="inline-code-span">n = m</code>입니다.</li><li><code class="inline-code-span">O</code>와 <code class="inline-code-span">S</code>는 disjoint<span class="footnote-ref" id="footnote-ref-1"><a href="#footnote-cite-1">[1]</a></span>합니다. 즉, <code class="inline-code-span">O</code>와 <code class="inline-code-span">S n&apos;</code>은 항상 다릅니다.</li></ul><h2 id="injection">injection</h2><p><a id="keywordinjection"></a></p><p>방금 설명한 injective를 구현한 tactic이 바로 <code class="inline-code-span">injection</code>입니다. 아래의 예시를 보겠습니다.</p><pre class="fenced-code-block line-num-width-1"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> injection_ex1 </span><span class="color-white">:</span><span class="color-white"> forall (n m o </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  [n;m] </span><span class="color-white">=</span><span class="color-white"> [o;o] </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  intros n m o </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  injection </span><span class="color-gold">H</span><span class="color-white"> as </span><span class="color-gold">H1</span> <span class="color-gold">H2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-white">  rewrite </span><span class="color-gold">H1</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">8</span><span class="code-fence-code"><span class="color-white">  rewrite </span><span class="color-gold">H2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">9</span><span class="code-fence-code"><span class="color-white">  reflexivity</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">10</span><span class="code-fence-code"><span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(1)">Copy</button></pre><p>위의 예시에서 <code class="inline-code-span">n = o</code>와 <code class="inline-code-span">m = o</code>는 자명해보입니다. 그 자명한 걸 표현하는 tactic이 <code class="inline-code-span">injection H as H1 H2</code>입니다.<br/> 저 tactic을 사용하고 나면 <code class="inline-code-span">H : [n; m] = [o; o]</code>가 사라지고 <code class="inline-code-span">H1 : n = o</code>와 <code class="inline-code-span">H2 : m = o</code>가 생깁니다. <code class="inline-code-span">injection</code>이 무슨 역할을 하는지 대충 감이 오죠?</p><p><a id="ex1"></a></p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> injection_S </span><span class="color-white">:</span><span class="color-white"> forall (n m </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code">  <span class="color-gold">S</span><span class="color-white"> n </span><span class="color-white">=</span> <span class="color-gold">S</span><span class="color-white"> m </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  intros n m </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  injection </span><span class="color-gold">H</span><span class="color-white"> as </span><span class="color-gold">Hnm</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">Hnm</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">8</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(2)">Copy</button></pre><p>위와 같은 방식으로도 쓸 수 있습니다. 처음에 나온 injective의 설명을 그대로 구현했습니다.</p><h2 id="discriminate">discriminate</h2><p><a id="keyworddiscriminate"></a></p><p>이번에는 아까 설명한 disjointness를 다뤄보겠습니다. Disjointness가 뭔지 다시 간략히 설명하자면, <u><code class="inline-code-span">S</code>와 <code class="inline-code-span">O</code>는 같지 않다</u>입니다. 근데 조금 이상하죠. 지금까지 증명을 하면서 <code class="inline-code-span">!=</code>나 <code class="inline-code-span">~=</code> 같은 걸 본 적이 없습니다. 그나마 있다고 해도 값들의 비교에서였지, 명제끼리 같지 않다고 말하는 건 들은 적이 없습니다. 그럼 과연 disjointness는 어디에 쓸까요?</p><p>잠시 논리학을 복습하겠습니다. <u>p이면 q이다</u>에서 <code class="inline-code-span">p</code>가 거짓이면 어떻게 되죠? 그럼 묻지도 따지지도 않고 명제는 참입니다. 즉, 가정이 거짓이면 명제는 참입니다. Coq에서도 이 방식으로 disjointness를 사용합니다. 아래의 예시를 보겠습니다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> discriminate_ex1 </span><span class="color-white">:</span><span class="color-white"> forall (n m </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  false </span><span class="color-white">=</span><span class="color-white"> true </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  intros n m contra</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  discriminate contra</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(3)">Copy</button></pre><p>위의 예시에서 <code class="inline-code-span">discriminate</code> tactic이 그 역할을 합니다. Coq에게 <code class="inline-code-span">discriminate contra</code>라는 명령을 하면 Coq는 <code class="inline-code-span">contra</code>의 가정이 거짓인지 확인하고 (이 과정에서 아까 설명한 disjointness를 사용합니다.) 가정이 거짓이라면 <code class="inline-code-span">contra</code>가 참이라고 합니다.</p><p>즉, context 안에 거짓인 명제 <code class="inline-code-span">A</code>가 있을 때 <code class="inline-code-span">discriminate A</code>를 하면 현재 진행 중인 증명이 완료됩니다.</p><h2 id="f_equal">f_equal</h2><p><a id="keywordfequal"></a></p><p><a href="#ex1">위</a>에서 <code class="inline-code-span">S m = S m</code>이면 <code class="inline-code-span">n = m</code>임을 증명했습니다. 반대방향으로 하려면 어떻게 해야할까요?</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> injection_rev </span><span class="color-white">:</span><span class="color-white"> forall (n m </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code">  <span class="color-gold">S</span><span class="color-white"> n </span><span class="color-white">=</span> <span class="color-gold">S</span><span class="color-white"> m</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  intros n m </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  f_equal</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">8</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(4)">Copy</button></pre><p>위와 같이 <code class="inline-code-span">f_equal</code>이라는 내장 tactic을 사용하면 됩니다. <code class="inline-code-span">f_equal</code>은 context의 <code class="inline-code-span">S n = S m</code>을 <code class="inline-code-span">n = m</code>으로 바꿔줍니다. <code class="inline-code-span">S</code>가 injective하다는 걸 알고 <code class="inline-code-span">S</code>를 한겹 벗겨주는 거죠. <code class="inline-code-span">f_equal</code>은 아주 다양한 곳에 활용할 수 있습니다. 아래의 예시를 보겠습니다.</p><pre class="fenced-code-block line-num-width-1"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> injection_rev2 </span><span class="color-white">:</span><span class="color-white"> forall (n m </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  [n;n;n] </span><span class="color-white">=</span><span class="color-white"> [m;m;m]</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  intros n m </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  f_equal</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">8</span><span class="code-fence-code"><span class="color-white">  f_equal</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">9</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">10</span><span class="code-fence-code"><span class="color-white">  f_equal</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">11</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">12</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(5)">Copy</button></pre><p>원소 3개짜리 list여서 <code class="inline-code-span">f_equal</code>을 총 3번 사용했습니다. <code class="inline-code-span">[n;n;n] = [m;m;m]</code>에 <code class="inline-code-span">f_equal</code>을 쓰면 <code class="inline-code-span">[n;n] = [m;m]</code>과 <code class="inline-code-span">n = m</code>으로 분리됩니다. 이런 식으로 <code class="inline-code-span">f_equal</code>을 한번 쓸 때마다 원소를 하나씩 분리할 수 있습니다.</p><hr/><div class="align-center"><p><a href="index.html">메인으로 돌아가기</a></p></div><div class="align-left"><p>&lt;&lt; <a href="Chap5-1.html">Chap5-1. Apply</a></p></div><div class="align-right"><p><a href="Chap5-3.html">Chap5-3. More tactics</a></p></div><hr class="footnote-hr"/><div class="mdxt-footnote-cites"><p><div class="footnote-cite"><a id="footnote-cite-0"></a>0. <a href="#footnote-ref-0"> [0]</a> 한국말로는 단사라고 합니다. 글에선 그냥 영어로 쓰겠습니다.</div><div class="footnote-cite"><a id="footnote-cite-1"></a>1. <a href="#footnote-ref-1"> [1]</a> 한국말로 뭐라고 하는지 기억이 안 나네요. 글에선 그냥 영어로 쓰겠습니다.</div></p></div><script>/*<![CDATA[*/
const fenced_code_block_contents = ["Inductive nat : Type :=\n  | O\n  | S (n : nat).", "Theorem injection_ex1 : forall (n m o : nat),\n  [n;m] = [o;o] ->\n  n = m.\nProof.\n  intros n m o H.\n  injection H as H1 H2.\n  rewrite H1.\n  rewrite H2.\n  reflexivity.\nQed.", "Theorem injection_S : forall (n m : nat),\n  S n = S m ->\n  n = m.\nProof.\n  intros n m H.\n  injection H as Hnm.\n  apply Hnm.\n  Qed.", "Theorem discriminate_ex1 : forall (n m : nat),\n  false = true ->\n  n = m.\nProof.\n  intros n m contra.\n  discriminate contra.\n  Qed.", "Theorem injection_rev : forall (n m : nat),\n  n = m ->\n  S n = S m.\nProof.\n  intros n m H.\n  f_equal.\n  apply H.\n  Qed.", "Theorem injection_rev2 : forall (n m : nat),\n  n = m ->\n  [n;n;n] = [m;m;m].\nProof.\n  intros n m H.\n  f_equal.\n  apply H.\n  f_equal.\n  apply H.\n  f_equal.\n  apply H.\n  Qed."];

function copy_code_to_clipboard(index) {
    navigator.clipboard.writeText(fenced_code_block_contents[index]);
}/*]]>*/</script>