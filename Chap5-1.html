<table><thead id="table-collapse-toggle-0" class="collapsible collapsed" onclick ="collapse_table('0')"><tr><th> Table of Contents </th></tr></thead><tbody id="collapsible-table-0" class="invisible"><tr><td><div class="toc"><ol type="1"><li><a href="#apply">Apply</a><ol type="1"><li><a href="#apply">apply</a></li><li><a href="#apply-with">apply with</a><ol type="1"><li><a href="#transitivity">transitivity</a></li><li><a href="#symmetry">symmetry</a></li></ol></li></ol></li></ol></div></td></tr></tbody></table><h1 id="apply">Apply</h1><p>5장에서는 더 다양한 tactic들을 살펴보겠습니다.</p><h2 id="apply">apply</h2><p>황당한 예시와 함께 5장을 시작해보겠습니다. 아래를 봅시다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> ridiculous</span><span class="color-white">:</span><span class="color-white"> forall (a b c d</span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  a </span><span class="color-white">=</span><span class="color-white"> b </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  (a </span><span class="color-white">=</span><span class="color-white"> b </span><span class="color-white">-&gt;</span><span class="color-white"> c </span><span class="color-white">=</span><span class="color-white"> d) </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  c </span><span class="color-white">=</span><span class="color-white"> d</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(0)">Copy</button></pre><p>위의 theorem을 증명하는 것은 아주 직관적입니다. <code class="inline-code-span">rewrite</code>를 2번 쓰면 끝입니다. 아래처럼요.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  intros a b c d eq1 eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  rewrite eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  reflexivity</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  rewrite eq1</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  reflexivity</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(1)">Copy</button></pre><p><a id="keywordapply"></a></p><p>간단하긴 하지만 더 간단한 방법이 있어보입니다. 증명을 하다보면 <code class="inline-code-span">rewrite</code> 뒤에 <code class="inline-code-span">reflexivity</code>가 바로 따라오는 경우가 많아요. 그런 상황을 간단하게 처리할 수 있는 tactic이 없을까요? 바로 <code class="inline-code-span">apply</code> tactic이 있습니다. 아래의 예시를 보겠습니다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  intros a b c d eq1 eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  apply eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  apply eq1</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(2)">Copy</button></pre><p>동일한 theorem을 <code class="inline-code-span">apply</code>를 이용해서 증명한 예시입니다. 코드가 훨씬 간결해진 걸 확인할 수 있습니다. 좀 더 복잡한 예시를 보겠습니다.</p><pre class="fenced-code-block line-num-width-1"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> less_ridiculous </span><span class="color-white">:</span><span class="color-white"> forall p</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  (forall n</span><span class="color-white">,</span><span class="color-white"> even n </span><span class="color-white">=</span><span class="color-white"> true </span><span class="color-white">-&gt;</span><span class="color-white"> even (</span><span class="color-gold">S</span><span class="color-white"> n) </span><span class="color-white">=</span><span class="color-white"> false) </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  (forall n</span><span class="color-white">,</span><span class="color-white"> even n </span><span class="color-white">=</span><span class="color-white"> false </span><span class="color-white">-&gt;</span><span class="color-white"> odd n </span><span class="color-white">=</span><span class="color-white"> true) </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  even p </span><span class="color-white">=</span><span class="color-white"> true </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  odd (</span><span class="color-gold">S</span><span class="color-white"> p) </span><span class="color-white">=</span><span class="color-white"> true</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code">
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">8</span><span class="code-fence-code"><span class="color-white">  intros p eq1 eq2 eq3</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">9</span><span class="code-fence-code"><span class="color-white">  apply eq2</span><span class="color-white">.</span><span class="color-white">  (*</span><span class="color-gray">{-</span><span class="color-gray"> forall n : nat, even n = false -&gt; odd n = true </span><span class="color-gray">-}</span><span class="color-white">*)
</span></span></span>
<span class="code-fence-row"><span class="code-fence-index">10</span><span class="code-fence-code"><span class="color-white">  apply eq1</span><span class="color-white">.</span><span class="color-white">  (*</span><span class="color-gray">{-</span><span class="color-gray"> forall n : nat, even n = true -&gt; even (S n) = false </span><span class="color-gray">-}</span><span class="color-white">*)
</span></span></span>
<span class="code-fence-row"><span class="code-fence-index">11</span><span class="code-fence-code"><span class="color-white">  apply eq3</span><span class="color-white">.</span><span class="color-white">  (*</span><span class="color-gray">{-</span><span class="color-gray"> even p = true </span><span class="color-gray">-}</span><span class="color-white">*)
</span></span></span>
<span class="code-fence-row"><span class="code-fence-index">12</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(3)">Copy</button></pre><p><code class="inline-code-span">apply</code>들의 순서를 바꿔보면, 다른 순서는 증명이 안됩니다. CoqIDE를 이용해서 직접 증명을 따라가보면 매 tactic마다 딱맞는 모양들이 나오는 걸 볼 수 있으실겁니다.</p><h2 id="apply-with">apply with</h2><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> trans_eq </span><span class="color-white">:</span><span class="color-white"> forall (</span><span class="color-gold">X</span> <span class="color-white">:</span> <span class="color-gold">Type</span><span class="color-white">) (n m o </span><span class="color-white">:</span> <span class="color-gold">X</span><span class="color-white">)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m </span><span class="color-white">-&gt;</span><span class="color-white"> m </span><span class="color-white">=</span><span class="color-white"> o </span><span class="color-white">-&gt;</span><span class="color-white"> n </span><span class="color-white">=</span><span class="color-white"> o</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  intros </span><span class="color-gold">X</span><span class="color-white"> n m o eq1 eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  rewrite </span><span class="color-white">-&gt;</span><span class="color-white"> eq1</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  rewrite </span><span class="color-white">-&gt;</span><span class="color-white"> eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-white">  reflexivity</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">8</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(4)">Copy</button></pre><p><a id="keywordapplywith"></a></p><p>앞으로 증명을 하면서 위의 성질을 쓸 일이 아주 많을 겁니다. 그래서 지금 정의해놓고 앞으로 필요할 때마다 <code class="inline-code-span">trans_eq</code>를 사용하기로 했습니다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Example</span><span class="color-white"> trans_eq_example </span><span class="color-white">:</span><span class="color-white"> forall (a b c d e f </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">     [a;b] </span><span class="color-white">=</span><span class="color-white"> [c;d] </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">     [c;d] </span><span class="color-white">=</span><span class="color-white"> [e;f] </span><span class="color-white">-&gt;</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">     [a;b] </span><span class="color-white">=</span><span class="color-white"> [e;f]</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  intros a b c d e f eq1 eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code"><span class="color-white">  apply trans_eq</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(5)">Copy</button></pre><p>이게 웬걸? 위의 코드는 에러가 납니다. <code class="inline-code-span">apply trans_eq</code>를 하면 Coq는 주어진 조건들에서 <code class="inline-code-span">m</code>을 찾으려고 시도합니다. 하지만 지금 증명하려는 식에는 <code class="inline-code-span">m</code>이 없습니다. <code class="inline-code-span">m</code>이 뭔지 알려주려면 어떻게 해야할까요? 아래와 같이 증명하면 됩니다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  intros a b c d e f eq1 eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-white">  apply trans_eq with (m </span><span class="color-white">:=</span><span class="color-white"> [c;d])</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  apply eq1</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  apply eq2</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(6)">Copy</button></pre><p><code class="inline-code-span">apply trans_eq with (m := [c;d])</code>라는 tactic을 통해서 <code class="inline-code-span">m</code> 자리에 <code class="inline-code-span">[c;d]</code>를 넣고 쓰면 된다고 Coq에게 명시적으로 알려주었습니다. 그럼 문제없이 <code class="inline-code-span">apply</code>를 사용할 수 있습니다. Coq는 추론능력이 뛰어나기 때문에 <code class="inline-code-span">apply trans_eq with [c;d]</code>라고만 해도 위의 증명이 문제없이 됩니다. 명시적인 걸 좋아하면 <code class="inline-code-span">m := [c;d]</code>를, 아니면 <code class="inline-code-span">[c;d]</code>를 쓰면 될 것 같습니다.</p><div class="box"><h3 id="transitivity">transitivity</h3><p><a id="keywordtransitivity"></a></p><p>위에서본 <code class="inline-code-span">trans_eq</code>는 워낙 자주 등장하는 성질이라 Coq에 기본적으로 정의돼 있습니다. 바로 <code class="inline-code-span">transitivity</code> tactic입니다.</p><pre class="fenced-code-block"><code><span class="code-fence-row"><span class="code-fence-code">Theorem trans_eq_example : forall (a b c d e f : nat),</span></span>
<span class="code-fence-row"><span class="code-fence-code">     [a;b] = [c;d] -&gt;</span></span>
<span class="code-fence-row"><span class="code-fence-code">     [c;d] = [e;f] -&gt;</span></span>
<span class="code-fence-row"><span class="code-fence-code">     [a;b] = [e;f].</span></span>
<span class="code-fence-row"><span class="code-fence-code">Proof.</span></span>
<span class="code-fence-row"><span class="code-fence-code">  intros a b c d e f eq1 eq2.</span></span>
<span class="code-fence-row"><span class="code-fence-code">  transitivity [c;d].</span></span>
<span class="code-fence-row"><span class="code-fence-code">  apply eq1.</span></span>
<span class="code-fence-row"><span class="code-fence-code">  apply eq2.</span></span>
<span class="code-fence-row"><span class="code-fence-code">  Qed.</span></span>
</code></pre><p>위의 증명에서 <code class="inline-code-span">transitivity</code>는 <code class="inline-code-span">apply trans_eq with</code>와 같습니다.</p></div><div class="box"><h3 id="symmetry">symmetry</h3><p><a id="keywordsymmetry"></a></p><p>또 황당한 예시를 하나 갖고 왔습니다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> another_ridiculous </span><span class="color-white">:</span><span class="color-white"> forall (n m </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m </span><span class="color-white">-&gt;</span><span class="color-white"> m </span><span class="color-white">=</span><span class="color-white"> n</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  intros n m </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">H</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(8)">Copy</button></pre><p>위의 방식으로는 증명이 안됩니다. <code class="inline-code-span">H</code>를 쓰려고 했지만 <code class="inline-code-span">n</code>과 <code class="inline-code-span">m</code>의 위치가 다릅니다. 그럴 때 쓸 수 있는게 <code class="inline-code-span">symmetry</code> tactic입니다. <code class="inline-code-span">symmetry</code>는 <code class="inline-code-span">=</code> 좌우를 반전시킵니다. <code class="inline-code-span">n = m</code>이나 <code class="inline-code-span">m = n</code>이나 동일한 뜻이잖아요. 그래서 아래의 증명은 성공적으로 동작합니다.</p><pre class="fenced-code-block line-num-width-0"><code><span class="code-fence-row"><span class="code-fence-index">1</span><span class="code-fence-code"><span class="color-gold">Theorem</span><span class="color-white"> another_ridiculous </span><span class="color-white">:</span><span class="color-white"> forall (n m </span><span class="color-white">:</span><span class="color-white"> nat)</span><span class="color-white">,</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">2</span><span class="code-fence-code"><span class="color-white">  n </span><span class="color-white">=</span><span class="color-white"> m </span><span class="color-white">-&gt;</span><span class="color-white"> m </span><span class="color-white">=</span><span class="color-white"> n</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">3</span><span class="code-fence-code"><span class="color-gold">Proof</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">4</span><span class="code-fence-code"><span class="color-white">  intros n m </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">5</span><span class="code-fence-code"><span class="color-white">  symmetry</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">6</span><span class="code-fence-code"><span class="color-white">  apply </span><span class="color-gold">H</span><span class="color-white">.</span>
</span></span>
<span class="code-fence-row"><span class="code-fence-index">7</span><span class="code-fence-code">  <span class="color-gold">Qed</span><span class="color-white">.</span></span></span>
</code><button class="copy-fenced-code" onclick="copy_code_to_clipboard(9)">Copy</button></pre></div><hr/><div class="align-center"><p><a href="index.html">메인으로 돌아가기</a></p></div><div class="align-left"><p>&lt;&lt; <a href="Chap4-2.html">Chap4-2. Higher Order Fuctions</a></p></div><div class="align-right"><p><a href="Chap5-2.html">Chap5-2. Injective and Disjoint</a> &gt;&gt;</p></div><script>/*<![CDATA[*/
const fenced_code_block_contents = ["Theorem ridiculous: forall (a b c d: nat),\n  a = b ->\n  (a = b -> c = d) ->\n  c = d.", "Proof.\n  intros a b c d eq1 eq2.\n  rewrite eq2.\n  reflexivity.\n  rewrite eq1.\n  reflexivity.\n  Qed.", "Proof.\n  intros a b c d eq1 eq2.\n  apply eq2.\n  apply eq1.\n  Qed.", "Theorem less_ridiculous : forall p,\n  (forall n, even n = true -> even (S n) = false) ->\n  (forall n, even n = false -> odd n = true) ->\n  even p = true ->\n  odd (S p) = true.\n\nProof.\n  intros p eq1 eq2 eq3.\n  apply eq2.  (*{- forall n : nat, even n = false -> odd n = true -}*)\n  apply eq1.  (*{- forall n : nat, even n = true -> even (S n) = false -}*)\n  apply eq3.  (*{- even p = true -}*)\n  Qed.", "Theorem trans_eq : forall (X : Type) (n m o : X),\n  n = m -> m = o -> n = o.\nProof.\n  intros X n m o eq1 eq2.\n  rewrite -> eq1.\n  rewrite -> eq2.\n  reflexivity.\n  Qed.", "Example trans_eq_example : forall (a b c d e f : nat),\n     [a;b] = [c;d] ->\n     [c;d] = [e;f] ->\n     [a;b] = [e;f].\nProof.\n  intros a b c d e f eq1 eq2.\n  apply trans_eq.", "Proof.\n  intros a b c d e f eq1 eq2.\n  apply trans_eq with (m := [c;d]).\n  apply eq1.\n  apply eq2.\n  Qed.", "", "Theorem another_ridiculous : forall (n m : nat),\n  n = m -> m = n.\nProof.\n  intros n m H.\n  apply H.", "Theorem another_ridiculous : forall (n m : nat),\n  n = m -> m = n.\nProof.\n  intros n m H.\n  symmetry.\n  apply H.\n  Qed."];

function copy_code_to_clipboard(index) {
    navigator.clipboard.writeText(fenced_code_block_contents[index]);
}/*]]>*/</script>